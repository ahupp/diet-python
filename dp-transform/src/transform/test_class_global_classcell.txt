$ class global classcell

def exercise():
    class X:
        global __class__
        __class__ = 42
        def f(self):
            return __class__
    x = X()
    value = x.f()
    global_value = globals()["__class__"]
    del globals()["__class__"]
    return value, global_value, X
=
def exercise():

    def _dp_ns_X(_dp_class_ns):

        def _dp_lambda_1():
            return __name__
        _dp_lambda_1 = __dp__.update_fn(_dp_lambda_1, "exercise.<locals>", "<lambda>")
        __dp__.setattr(_dp_class_ns, "__module__", __dp__.class_lookup(_dp_class_ns, "__name__", _dp_lambda_1))
        __dp__.setattr(_dp_class_ns, "__qualname__", "exercise.<locals>.X")
        global __class__
        __class__ = 42

        def f(self):
            return __class__

        def _dp_lambda_2():
            return f
        _dp_lambda_2 = __dp__.update_fn(_dp_lambda_2, "exercise.<locals>", "<lambda>")
        __dp__.setattr(_dp_class_ns, "f", __dp__.update_fn(__dp__.class_lookup(_dp_class_ns, "f", _dp_lambda_2), "exercise.<locals>.X", "<locals>"))
    X = __dp__.create_class("X", _dp_ns_X, (), None)
    x = X()
    value = x.f()
    global_value = __dp__.getitem(globals(), "__class__")
    __dp__.delitem(globals(), "__class__")
    return value, global_value, X
