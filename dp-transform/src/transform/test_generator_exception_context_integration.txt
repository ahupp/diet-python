$ generator exception context

from __future__ import annotations


def exercise():
    def f():
        try:
            raise KeyError("a")
        except Exception:
            yield

    gen = f()
    gen.send(None)
    try:
        gen.throw(ValueError)
    except Exception as exc:
        context = exc.__context__
        return type(context), getattr(context, "args", None)
    return None, None
=
def _dp_fn_exercise():

    def _dp_fn_f():
        try:
            raise KeyError("a")
        except:
            if __dp__.exception_matches(__dp__.current_exception(), Exception):
                yield
            else:
                raise
    f = __dp__.update_fn(_dp_fn_f, "exercise.<locals>", "f")
    del _dp_fn_f
    gen = f()
    gen.send(None)
    try:
        gen.throw(ValueError)
    except:
        if __dp__.exception_matches(__dp__.current_exception(), Exception):
            exc = __dp__.current_exception()
            try:
                context = exc.__context__
                return type(context), getattr(context, "args", None)
            finally:
                try:
                    del exc
                except:
                    if __dp__.exception_matches(__dp__.current_exception(), NameError):
                        pass
                    else:
                        raise
        else:
            raise
    return None, None
exercise = __dp__.update_fn(_dp_fn_exercise, None, "exercise")
del _dp_fn_exercise
