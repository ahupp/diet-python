$ scope locals
def function_locals():
    def f(x):
        def g(y):
            def h(z):
                return y + z
            w = x + y
            y += 3
            return locals()
        return g

    return f(2)(4)


def class_locals():
    def f(x):
        class C:
            y = x
            def m(self):
                return x
            z = list(locals())
        return C

    return f(1).z


def class_namespace_overrides_closure():
    x = 42
    class X:
        locals()["x"] = 43
        y = x
    return X.y
=
def _dp_fn_function_locals():

    def _dp_fn_f(x):

        def _dp_fn_g(y):

            def _dp_fn_h(z):
                return __dp__.add(y, z)
            h = __dp__.update_fn(_dp_fn_h, "function_locals.<locals>.f.<locals>.g.<locals>", "h")
            del _dp_fn_h
            w = __dp__.add(x, y)
            y = __dp__.iadd(y, 3)
            return locals()
        g = __dp__.update_fn(_dp_fn_g, "function_locals.<locals>.f.<locals>", "g")
        del _dp_fn_g
        return g
    f = __dp__.update_fn(_dp_fn_f, "function_locals.<locals>", "f")
    del _dp_fn_f
    return f(2)(4)
function_locals = __dp__.update_fn(_dp_fn_function_locals, None, "function_locals")
del _dp_fn_function_locals
def _dp_fn_class_locals():

    def _dp_fn_f(x):

        def _dp_create_class_class_locals__locals__f__locals__C():

            def _dp_ns_builder(_dp_class_ns):

                def _dp_lambda_1():
                    return __name__
                _dp_lambda_1.__name__ = "<lambda>"
                _dp_lambda_1.__qualname__ = "class_locals.<locals>.f.<locals>.<lambda>"
                _dp_class_ns.__module__ = __dp__.class_lookup("__name__", _dp_class_ns, _dp_lambda_1)
                _dp_class_ns.__qualname__ = "class_locals.<locals>.f.<locals>.C"
                _dp_class_ns.__annotations__ = __dp__.dict()

                def _dp_lambda_2():
                    return x
                _dp_lambda_2.__name__ = "<lambda>"
                _dp_lambda_2.__qualname__ = "class_locals.<locals>.f.<locals>.<lambda>"
                _dp_class_ns.y = __dp__.class_lookup("x", _dp_class_ns, _dp_lambda_2)

                def _dp_fn_m(self):
                    return x
                _dp_class_ns.m = __dp__.update_fn(_dp_fn_m, "class_locals.<locals>.f.<locals>.C", "m")

                def _dp_lambda_3():
                    return list
                _dp_lambda_3.__name__ = "<lambda>"
                _dp_lambda_3.__qualname__ = "class_locals.<locals>.f.<locals>.<lambda>"
                _dp_class_ns.z = __dp__.class_lookup("list", _dp_class_ns, _dp_lambda_3)(_dp_class_ns._namespace)
            return __dp__.create_class("C", _dp_ns_builder, (), None)
        C = _dp_create_class_class_locals__locals__f__locals__C()
        return C
    f = __dp__.update_fn(_dp_fn_f, "class_locals.<locals>", "f")
    del _dp_fn_f
    return f(1).z
class_locals = __dp__.update_fn(_dp_fn_class_locals, None, "class_locals")
del _dp_fn_class_locals
def _dp_fn_class_namespace_overrides_closure():
    x = 42

    def _dp_create_class_class_namespace_overrides_closure__locals__X():

        def _dp_ns_builder(_dp_class_ns):

            def _dp_lambda_4():
                return __name__
            _dp_lambda_4.__name__ = "<lambda>"
            _dp_lambda_4.__qualname__ = "class_namespace_overrides_closure.<locals>.<lambda>"
            _dp_class_ns.__module__ = __dp__.class_lookup("__name__", _dp_class_ns, _dp_lambda_4)
            _dp_class_ns.__qualname__ = "class_namespace_overrides_closure.<locals>.X"
            _dp_class_ns.__annotations__ = __dp__.dict()
            __dp__.setitem(_dp_class_ns._namespace, "x", 43)

            def _dp_lambda_5():
                return x
            _dp_lambda_5.__name__ = "<lambda>"
            _dp_lambda_5.__qualname__ = "class_namespace_overrides_closure.<locals>.<lambda>"
            _dp_class_ns.y = __dp__.class_lookup("x", _dp_class_ns, _dp_lambda_5)
        return __dp__.create_class("X", _dp_ns_builder, (), None)
    X = _dp_create_class_class_namespace_overrides_closure__locals__X()
    return X.y
class_namespace_overrides_closure = __dp__.update_fn(_dp_fn_class_namespace_overrides_closure, None, "class_namespace_overrides_closure")
del _dp_fn_class_namespace_overrides_closure
