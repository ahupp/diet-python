$ rewrites function annotations

from __future__ import annotations

def f(x: list[int], y: dict[str, int]) -> tuple[str, ...]:
    return x
=
def f(x: "list[int]", y: "dict[str, int]") -> "tuple[str, ...]":
    return x
f.__qualname__ = "f"
f.__code__ = f.__code__.replace(co_qualname="f")

$ preserves other future imports

from __future__ import annotations, division

def g(x: int | None):
    pass
=
from __future__ import division
def g(x: "int | None"):
    pass
g.__qualname__ = "g"
g.__code__ = g.__code__.replace(co_qualname="g")

$ leaves annotations untouched without future import

def h(x: list[int]):
    return x
=
def h(x: __dp__.getitem(list, int)):
    return x
h.__qualname__ = "h"
h.__code__ = h.__code__.replace(co_qualname="h")
